{"ast":null,"code":"\"use strict\";\n\nrequire(\"core-js/modules/es.symbol\");\n\nrequire(\"core-js/modules/es.symbol.description\");\n\nrequire(\"core-js/modules/es.symbol.iterator\");\n\nrequire(\"core-js/modules/es.array.concat\");\n\nrequire(\"core-js/modules/es.array.filter\");\n\nrequire(\"core-js/modules/es.array.from\");\n\nrequire(\"core-js/modules/es.array.iterator\");\n\nrequire(\"core-js/modules/es.array.slice\");\n\nrequire(\"core-js/modules/es.object.entries\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptor\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptors\");\n\nrequire(\"core-js/modules/es.object.keys\");\n\nrequire(\"core-js/modules/es.object.to-string\");\n\nrequire(\"core-js/modules/es.regexp.exec\");\n\nrequire(\"core-js/modules/es.string.iterator\");\n\nrequire(\"core-js/modules/es.string.replace\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\n\nvar _utils = require(\"../../utils/utils\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"];\n\n  if (_i == null) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n\n  var _s, _e;\n\n  try {\n    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    enumerableOnly && (symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? ownKeys(Object(source), !0).forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) {\n      Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n    });\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\n\nvar Alert = /*#__PURE__*/function () {\n  function Alert(container, component) {\n    _classCallCheck(this, Alert);\n\n    this.container = container;\n    this.alert = null;\n    this.parentComponent = component;\n    this.refs = {};\n    this.loadRefs = this.parentComponent.loadRefs.bind(this);\n  }\n\n  _createClass(Alert, [{\n    key: \"refsNames\",\n    get: function get() {\n      return {\n        messageRef: 'multiple'\n      };\n    }\n  }, {\n    key: \"alertTypes\",\n    get: function get() {\n      return {\n        error: 'danger',\n        success: 'success',\n        info: 'info',\n        warning: 'warning'\n      };\n    }\n  }, {\n    key: \"showErrors\",\n    value: function showErrors() {\n      var errors = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n      var triggerEvent = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      errors = _lodash.default.isArray(errors) ? errors : [errors];\n      var messagesList = this.createMessagesList('error', errors);\n      this.showAlert('error', messagesList, options);\n\n      if (triggerEvent) {\n        this.parentComponent.emit('error', errors);\n      }\n\n      return errors;\n    }\n  }, {\n    key: \"showMessage\",\n    value: function showMessage(message, type) {\n      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var messageElement = message;\n\n      if (messageElement instanceof HTMLElement) {\n        messageElement.setAttribute('ref', 'messageRef');\n      } else {\n        messageElement = this.parentComponent.ce('p', {\n          ref: 'messageRef'\n        });\n      }\n\n      this.showAlert(type, messageElement, options);\n    }\n  }, {\n    key: \"createMessagesList\",\n    value: function createMessagesList(type) {\n      switch (type) {\n        case 'error':\n          for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n            args[_key - 1] = arguments[_key];\n          }\n\n          return this.createErrorList.apply(this, args);\n      }\n    }\n  }, {\n    key: \"createErrorList\",\n    value: function createErrorList(errors) {\n      var _this = this;\n\n      var p = this.parentComponent.ce('p');\n      this.parentComponent.setContent(p, this.parentComponent.t('error'));\n      var ul = this.parentComponent.ce('ul');\n      var messagesList = document.createDocumentFragment();\n      errors.forEach(function (err) {\n        return _this.appendErrorToList(err, ul);\n      });\n      p.appendChild(ul);\n      messagesList.appendChild(p);\n      return messagesList;\n    }\n  }, {\n    key: \"showAlert\",\n    value: function showAlert(type, messagesList) {\n      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var customClasses = options.customClasses,\n          customEvents = options.customEvents;\n      this.setAlert(type, messagesList, {\n        customClasses: customClasses\n      });\n\n      if (!this.alert) {\n        return;\n      }\n\n      this.attach({\n        customEvents: customEvents\n      });\n      this.parentComponent.prependTo(this.alert, this.container);\n    }\n  }, {\n    key: \"setAlert\",\n    value: function setAlert(type, messagesList) {\n      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var alertType = this.alertTypes[type];\n\n      if (this.alert) {\n        this.clear();\n      }\n\n      if (messagesList) {\n        var _options$id = options.id,\n            id = _options$id === void 0 ? \"\".concat(type, \"-list-\").concat(this.parentComponent.id) : _options$id,\n            _options$customClasse = options.customClasses,\n            customClasses = _options$customClasse === void 0 ? \"alert alert-\".concat(alertType) : _options$customClasse;\n        this.alert = this.parentComponent.ce('div', {\n          id: id,\n          class: customClasses\n        });\n\n        if (messagesList instanceof HTMLElement) {\n          this.parentComponent.appendTo(messagesList, this.alert);\n        } else {\n          this.parentComponent.setContent(this.alert, messagesList);\n        }\n      }\n    }\n  }, {\n    key: \"attach\",\n    value: function attach(options) {\n      var _customEvents$click,\n          _customEvents$keypres,\n          _this2 = this,\n          _this$refs$messageRef;\n\n      var _options$customEvents = options.customEvents,\n          customEvents = _options$customEvents === void 0 ? {} : _options$customEvents;\n      this.eventListenersKeys = [];\n      this.loadRefs(this.alert, this.refsNames);\n      var clickListeners = ((_customEvents$click = customEvents.click) === null || _customEvents$click === void 0 ? void 0 : _customEvents$click.listeners) || [];\n      var keyPressListeners = ((_customEvents$keypres = customEvents.keypress) === null || _customEvents$keypres === void 0 ? void 0 : _customEvents$keypres.listeners) || [];\n      customEvents = _objectSpread(_objectSpread({}, customEvents), {}, {\n        click: [].concat(_toConsumableArray(clickListeners), [function (e) {\n          var key = e.currentTarget.dataset.componentKey;\n\n          _this2.focusOnComponent(key);\n        }]),\n        keypress: [].concat(_toConsumableArray(keyPressListeners), [function (e) {\n          var key = e.currentTarget.dataset.componentKey;\n\n          _this2.focusOnComponent(key);\n        }])\n      });\n\n      if ((_this$refs$messageRef = this.refs.messageRef) !== null && _this$refs$messageRef !== void 0 && _this$refs$messageRef.length) {\n        this.refs.messageRef.forEach(function (el) {\n          Object.entries(customEvents).forEach(function (_ref) {\n            var _ref2 = _slicedToArray(_ref, 2),\n                event = _ref2[0],\n                listeners = _ref2[1];\n\n            listeners.forEach(function (listener) {\n              return _this2.parentComponent.addEventListener(el, event, listener);\n            });\n\n            _this2.eventListenersKeys.push(event);\n          });\n        });\n      }\n    }\n  }, {\n    key: \"clear\",\n    value: function clear() {\n      var _this3 = this;\n\n      try {\n        var _this$refs$messageRef2;\n\n        if ((_this$refs$messageRef2 = this.refs.messageRef) !== null && _this$refs$messageRef2 !== void 0 && _this$refs$messageRef2.length) {\n          this.refs.messageRef.forEach(function (el) {\n            _this3.eventListenersKeys.forEach(function (event) {\n              return _this3.parentComponent.removeEventListener(el, event);\n            });\n          });\n        }\n\n        this.refs = {};\n        this.parentComponent.removeChildFrom(this.alert, this.container);\n        this.alert = null;\n      } catch (err) {// ignore\n      }\n    }\n  }, {\n    key: \"focusOnComponent\",\n    value: function focusOnComponent(keyOrPath) {\n      if (keyOrPath) {\n        var _this$parentComponent;\n\n        var path = this.parentComponent._parentPath ? keyOrPath.replace(this.parentComponent._parentPath, '') : keyOrPath;\n        var component = (_this$parentComponent = this.parentComponent.root) === null || _this$parentComponent === void 0 ? void 0 : _this$parentComponent.getComponent(path, null, keyOrPath);\n\n        if (component && _lodash.default.isFunction(component.focus)) {\n          component.focus();\n        }\n      }\n    }\n  }, {\n    key: \"createMessage\",\n    value: function createMessage(type, element, message, index, err) {\n      switch (type) {\n        case 'error':\n          return this.createErrorMessage(element, message, index, err);\n      }\n    }\n  }, {\n    key: \"createErrorMessage\",\n    value: function createErrorMessage(element, message, index, err) {\n      var _err$messages, _err$component;\n\n      var params = {\n        style: 'cursor: pointer',\n        ref: 'messageRef',\n        tabIndex: 0,\n        'aria-label': \"\".concat(message, \". Click to navigate to the field with following error.\")\n      };\n      var li = this.parentComponent.ce('li', params);\n      this.parentComponent.setContent(li, message);\n      var messageFromIndex = !_lodash.default.isUndefined(index) && (err === null || err === void 0 ? void 0 : (_err$messages = err.messages) === null || _err$messages === void 0 ? void 0 : _err$messages[index]);\n      var keyOrPath = (messageFromIndex === null || messageFromIndex === void 0 ? void 0 : messageFromIndex.path) || (err === null || err === void 0 ? void 0 : (_err$component = err.component) === null || _err$component === void 0 ? void 0 : _err$component.key);\n\n      if (keyOrPath) {\n        var formattedKeyOrPath = (0, _utils.getStringFromComponentPath)(keyOrPath);\n        li.dataset.componentKey = formattedKeyOrPath;\n      }\n\n      this.parentComponent.appendTo(li, element);\n    }\n  }, {\n    key: \"appendErrorToList\",\n    value: function appendErrorToList(err, ul) {\n      var _err$messages2,\n          _this4 = this;\n\n      if (err !== null && err !== void 0 && (_err$messages2 = err.messages) !== null && _err$messages2 !== void 0 && _err$messages2.length) {\n        err.messages.forEach(function (_ref3, index) {\n          var message = _ref3.message;\n\n          _this4.createMessage('error', ul, message, index, err);\n        });\n      } else if (err) {\n        var message = _lodash.default.isObject(err) ? err.message || '' : err;\n        this.createMessage('error', ul, message);\n      }\n    }\n  }]);\n\n  return Alert;\n}();\n\nexports.default = Alert;","map":null,"metadata":{},"sourceType":"script"}